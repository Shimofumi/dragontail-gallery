---
import path from 'path';
import type { MarkdownInstance } from 'astro';
import type { ArtworkFrontmatter } from '../layouts/Artwork.astro';
import Layout from "../layouts/Layout.astro";

const pageTitle: string = "gallery";
const artworks: MarkdownInstance<ArtworkFrontmatter>[] = Object.values(import.meta.glob('./picture/*.md', { eager: true }));
artworks.sort((a, b) => {
	const aDate = new Date(a.frontmatter.date);
	const bDate = new Date(b.frontmatter.date);
	return bDate.getTime() - aDate.getTime()
})
---

<Layout title={pageTitle}>
	<div class="grid-wrapper">
		<div class="gallery-grid">
			{
				artworks.map((work) => {
					const image =work.frontmatter.image;
					const ext = path.extname(image);
				    const thumbnail_basename = path.basename(image, ext); // notes

						return (
						<p class="gallery-piece">
							<a href={work.url}><img src={`/thumbnails/${thumbnail_basename}_thumb${ext}`}></a>
							<span class="gallery-title">{work.frontmatter.title}</span>
						</p>
					)
				})
			}
		</div>
	</div>
</Layout>
